# 正则表达式应用实例

## ATTENTION

如果出现匹配不到的问题，可以检查一下有没有中文的逗号混迹其中，中文标点不会报错！`!{1,}`与`!{1，}`

## 知识点

[\s]表示，只要出现空白就匹配
[\S]表示，非空白就匹配
正则表达式的语法在各个地方不尽相同，有细微差别，以后标注好在哪里使用的。

例如，在VSCODE中子串的引用为`$1`，python的re模块中为`\1`

## 匹配中文字符

[resource](http://caibaojian.com/zhongwen-regexp.html)

匹配中文字符的正则表达式： `[\u4e00-\u9fa5]`
匹配双字节字符(包括汉字在内)： `[^\x00-\xff]`
英文字母: `[a-zA-Z]`
数字: `[0-9]`
匹配中文，英文字母和数字及_:`^[\u4e00-\u9fa5_a-zA-Z0-9]+$`
由数字、26 个英文字母或者下划线组成的字符串`\w+`

一个正则表达式，只含有汉字、数字、字母、下划线不能以下划线开头和结尾：

```r
^(?!_)(?!.*?_$)[a-zA-Z0-9_\u4e00-\u9fa5]+$\
```

其中：
sign|meaning
---|---
`^`|与字符串开始的地方匹配
`(?!_)`|不能以_开头
`(?!.*?_$)`|不能以_结尾
`[a-zA-Z0-9_\u4e00-\u9fa5]+`|至少一个汉字、数字、字母、下划线

## 在中文和英文中间增加空格

**这里用`_`代表空格：**

1. `([\w]{1,})`->`_$1_`
2. `\s{2,}`->`_`

当然，还有很多很多其他实现方式，网上找到的先放在这里
`([\u4e00-\u9fa5]+)([A-Za-z]+)([\u4e00-\u9fa5]+)`->`$1 $2 $3`

或者
`([^\w]*?)([\w]+)([^\w]*?)`左右都匹配一下非`\w`匹配的内容。

## 单行模式和多行模式

### 背景知识

这里是在python中re模块中测试的

正则表达式中 \s 匹配任何空白字符，包括空格、制表符、换页符等等，等价于 `[\f\n\r\t\v]`
    `\f` -> 匹配一个换页
    `\n` -> 匹配一个换行符
    `\r` -> 匹配一个回车符
    `\t` -> 匹配一个制表符
    `\v` -> 匹配一个垂直制表符

windows 中换行符为`\r\n`

- 单行模式下，文本被当做只有一行，也就是说，`^`是所有文字的开头,`$`是所有文字的结尾，即使文字中间有换行符也不算数。
- 多行模式就是改变了`^`和`$`的识别方位，（测试得到以及查资料看到），这两个是根据`\n`的位置来识别的。

### 要注意的地方

有些时候（比如说我们复制了一大段文字，有很多行），想要处理时，单行模式认为只有一行，不是很方便。

但是要注意，windows中一行包括`\r\n`，而`\r`又包括在`\s`中，所以应该注意一下，正则表达式中在多行模式下使用这个符号会把`\r`处理掉！（不过好像并不影响显示！）

**另外要匹配真正的行尾，应该是**`(...)(\r?)$`
`\r?`是因为，在段落中间有回车换行时，`\r`存在，在文字的末尾可能没有换行符（没有空行）。

## 匹配字符串的引用

查找替换中常需要对匹配到的字符串进行引用

正则表达式中加了()的被看做一个整体，可以使用`$1`、`$2`引用
`$0`代表匹配到的字符串本身

## 将表格类信息进行两种形式的转化

有时候我们会获得一个表格

```markdown
|head1|head2|head3|head4|
| --- | --- | --- | --- |
|t11|t12|t13|t14|
|t21|t22|t23|t24|
....
```

而有时候我们会获得

```markdown
head1:
t11;
head2:
t21;
head3:
t31;
head4:
t41;
```

在两种形式之间转化，先暂记从表格到顺序形式

`\n\|(.+?)\|(.+?)\|(.+?)\|(.+?)\|`->`\nstring1\n$1\nstring2\n$2\nstring3\n$3\nstring4\n$4\n`
